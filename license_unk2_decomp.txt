signed int __cdecl license_unk2(int dSerialNumber, int *a2, int *a3, int *a4)
{
  signed int result; // eax@2
  char v5; // cl@3
  int v6; // edi@3
  int v7; // ebp@3
  int v8; // esi@3
  int v9; // edi@3
  int v10; // eax@20
  int v11; // edx@34
  int v12; // ecx@34

  if ( dSerialNumber == dword_1BB4294 )
  {
    result = dword_1BB42A4;
    *a2 = dword_1BB42A4 != 0 ? dword_1BB4298 : 0;
    *a3 = result != 0 ? dword_1BB429C : 0;
    *a4 = result != 0 ? dword_1BB42A0 : 0;
    return result;
  }
  *a2 = 0;
  *a3 = 0;
  v5 = dSerialNumber ^ ((dSerialNumber >> 16) - BYTE1(dSerialNumber));
  *a4 = 0;
  v6 = (unsigned __int8)(dSerialNumber ^ (unsigned __int8)(BYTE1(dSerialNumber) - v5));
  v7 = v6 ^ (unsigned __int8)(dSerialNumber - v5);
  v8 = (v6 | ((unsigned __int8)(dSerialNumber ^ (unsigned __int8)((dSerialNumber >> 16) - BYTE1(dSerialNumber))) << 8)) << 16;
  dword_1BB4294 = dSerialNumber;
  dword_1BB42A4 = 0;
  v9 = BYTE3(dSerialNumber);
  if ( BYTE3(dSerialNumber) )
    v9 = BYTE3(dSerialNumber) ^ 0x55;
  if ( v8 > (unsigned int)_time64(0) + 172800
    || v9 && v9 != 80 && v9 != 81 && v9 != 82 && v9 != 83 && v9 != 84 && v9 != 86 )
    return 0;
  if ( v7 == 237 )
  {
    if ( !v9 )
    {
      if ( (unsigned int)(v8 - 757296000) <= 0x1166BC7F )
      {
        *a2 = 2 - ((unsigned int)v8 < 0x34FB4800);
        *a3 = (unsigned int)v8 < 0x34FB4800 ? 0 : 6;
LABEL_33:
        *a4 = v8;
        goto LABEL_34;
      }
      return 0;
    }
    if ( v9 == 86 )
    {
      if ( (unsigned int)(v8 - 888796800) > 0x990317F )
        return 0;
      *a2 = 2;
      *a3 = 6;
      *a4 = v8;
LABEL_34:
      v11 = *a2;
      v12 = *a3;
      dword_1BB42A0 = v8;
      result = 1;
      dword_1BB4298 = v11;
      dword_1BB429C = v12;
      dword_1BB42A4 = 1;
      return result;
    }
  }
  v10 = v7 ^ v9 ^ 0x50;
  if ( v10 != 237 || v9 != 86 )
  {
    if ( v7 != 237 || v9 < 80 )
    {
      if ( v10 != 237 || v9 < 80 || (unsigned int)v8 < 0x3E614980 )
        return 0;
      *a2 = 4;
    }
    else
    {
      result = 0;
      if ( (unsigned int)v8 < 0x3E614980 )
        return result;
      LOBYTE(result) = dSerialNumber == 120679812;
      *a2 = result + 3;
    }
    *a3 = v9 - 80;
    goto LABEL_33;
  }
  if ( (unsigned int)(v8 - 888796800) <= 0x990317F )
  {
    *a2 = 4;
    *a3 = 6;
    *a4 = v8;
    goto LABEL_34;
  }
  return 0;
}